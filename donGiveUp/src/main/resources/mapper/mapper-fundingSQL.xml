<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="funding">
	<select id="selectList" parameterType="map" resultType="funding">
		select 
			funding_no as fundingNo,funding_title as fundingTitle,
			funding_content as fundingContent, funding_group as fundingGroup,
			funding_group_introduce as fundingGroupIntroduce,
			funding_class as fundingClass, funding_type as fundingType,
			funding_start_date as fundingStartDate, funding_end_date as fundingEndDate,
			funding_manager as fundingManager, funding_goal_price as fundingGoalPRice,
			funding_now_price as fundingNowPrice, funding_negative as fundingNegative,
			(select 
	            funding_filepath 
		        from fundingimg s 
		        where s.funding_no = f.funding_no and 
		        funding_img_no= (
		            select min(funding_img_no) 
		            from fundingimg u
		            where s.funding_no = u.funding_no)
	        ) as fundingFilepath
			from (select rownum, m.* from(select * from funding where funding_type = 1 
			<if test="type != null">
				and
				funding_class =#{type}
				<!-- <if test="type.equals('0')">
					 funding_class = 0 
				</if>
				<if test="type.equals('1')">
					funding_class = 1 
				</if>
				<if test="type.equals('2')">
					funding_class = 2 
				</if> -->
			</if>
			
				order by funding_no desc 
				)m
			)f
			where rownum between  #{rnumMin} and #{rnumMax}

	</select>	
	<select id="selectOne" parameterType="map" resultType="_int">
		select count(*)
			from funding
		<if test="type != null">
			where 
				funding_class = #{type}
		</if>
	</select>
		
</mapper>
